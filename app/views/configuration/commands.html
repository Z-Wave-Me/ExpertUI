<!-- Commands view -->
<div ng-controller="ConfigCommandsController">
    <!-- Config navigation -->
    <div ng-include="'app/views/configuration/navi.html'"></div>
    <!--<pre>{{ccTable['Basic']|json}}</pre>-->
    <div class="row row-configuration">
        <div class="col-md-3 menu-vertical">
            <div ng-include="'app/views/configuration/menu.html'"></div>
            <button type="button" ng-click="collapse()" class="btn btn-default">Collapse</button>
        </div>
        <div class="col-md-9 col-content">
            <bb-alert alert="alert"></bb-alert>
            <div ng-if="deviceId">
                <div ng-repeat="command in commands track by $index" class="panel panel-command" ng-init="expanded[$index] = true">
                    <div class="panel-heading command" data-toggle="collapse" data-target="#{{$index}}" ng-click="expanded[$index] = !expanded[$index]" aria-expanded="true" aria-controls="collapseExample">
                        <button class="btn btn-default"
                                ng-click="handleCmdClassModal('cmdClassModal',$event,command.instanceId, $index, command.ccId, 'cmdDataIn')">
                            {{_t('th_instance')}}: {{command.instanceId}}
                        </button>
                        <button class="btn btn-default"
                                ng-click="handleCmdClassModal('cmdClassModal',$event,command.instanceId,$index,command.ccId, 'cmdData')">
                            {{_t('th_command_class')}}: {{command.commandClass}}
                        </button>
                        <div style="margin-left: auto;">
                            <i ng-if="!command.hidden || ccTable[command.commandClass]" class="fa accordion-arrow fa-chevron-down fa-lg command-arrow" ng-class="{'rotated': expanded[$index]}" style="line-height: 200%"></i>
                        </div>
                    </div>
                    <div class="collapse in" id="{{$index}}" ng-if="!command.hidden || ccTable[command.commandClass]">
                        <div class="commands-table" ng-class="{'with': ccTable[command.commandClass]}">
                            <div class="commands-table-info" ng-if="ccTable[command.commandClass]">
                                <div>
                                    <table class="table table-striped table-condensed"
                                           ng-if="_.size(ccTable[command.commandClass].rows)">
                                        <thead ng-if="commandName(command.commandClass).valArray">
                                            <tr>
                                                <th>#</th>
                                                <th>{{commandName(command.commandClass).th[0]}}</th>
                                                <th>&nbsp;</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="{{command.isEqual ? 'na':'bcg-success'}}"
                                                ng-repeat="v in ccTable[command.commandClass].rows track by $index">
                                                <td style="white-space: nowrap;">
                                                    {{v.id}}&nbsp
                                                </td>
                                                <td style="white-space: nowrap;">
                                                    <span ng-bind="v.value"></span>
                                                </td>
                                                <td style="white-space: nowrap;">
                                                    <span ng-class="v.isUpdated ? 'green':'red'">{{v.updateTime | isTodayFromUnix}} </span>
                                                </td>

                                            </tr>
                                        </tbody>

                                    </table>
                                </div>
                            </div>
                            <div>
                                <z-wave-expert-command ng-repeat="(k, m) in command.methods track by $index" action="k"
                                                       data="m"
                                                       options="{cmd: command.cmd, method: k}"></z-wave-expert-command>
                                <z-wave-expert-command ng-repeat="(k, m) in command.dataParams track by $index"
                                                       action="k" data="m"
                                                       options="{cmd: command.cmd, param: k}"></z-wave-expert-command>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Modal Command class -->
            <div ng-include="'app/views/configuration/modal_cmdclass.html'"></div>
        </div>
    </div>
</div><!-- /ng-controler -->
